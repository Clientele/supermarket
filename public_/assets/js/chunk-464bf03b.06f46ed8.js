(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-464bf03b"],{3604:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-list-container",attrs:{id:"data-list-list-view"}},[a("vehicle-form",{attrs:{isSidebarActive:e.addNewDataSidebar,data:e.sidebarData},on:{closeSidebar:e.toggleDataSidebar}}),a("vs-table",{ref:"table",attrs:{multiple:"",pagination:"","max-items":e.itemsPerPage,search:"",data:e.refinedVehicles},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.data;return[a("tbody",e._l(s,(function(t,s){return a("vs-tr",{key:s,attrs:{data:t}},[a("vs-td",[a("p",{staticClass:"product-name font-medium truncate"},[e._v(e._s(t.make)+" "+e._s(t.licence_plate_number))])]),a("vs-td",[a("p",{staticClass:"product-category"},[e._v(e._s(t.vehicle_type)+" ")])]),a("vs-td",[t.staff?a("vs-chip",{attrs:{color:"#8a5a44"}},[e._v(" "+e._s(t.staff.staff_name)+" ")]):a("vs-chip",{attrs:{color:"grey"}},[e._v(" No Staff ")])],1),a("vs-td",{staticClass:"whitespace-no-wrap"},[a("p",{staticClass:"product-category"},[a("vs-chip",{staticClass:"product-order-status",attrs:{color:e.getOrderStatusColor(t.vehicle_status)}},[e._v(e._s(t.vehicle_status))])],1)]),a("vs-td",{staticClass:"whitespace-no-wrap"},[a("vs-button",{staticClass:"mr-2",attrs:{color:"secondary",size:"small",type:"border"},on:{click:function(a){return e.editVehicle(t)}}},[e._v("Edit")]),a("vs-button",{attrs:{color:"danger",size:"small",type:"border"},on:{click:function(a){return e.confirmDepotDeletion(t)}}},[e._v("Delete")])],1)],1)})),1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("div",{staticClass:"flex flex-wrap-reverse items-center flex-grow justify-between",attrs:{slot:"header"},slot:"header"},[a("div",{staticClass:"flex flex-wrap-reverse items-center data-list-btn-container"},[a("vs-icon",{staticClass:"mr-2",attrs:{icon:"local_shipping",size:"large",color:"primary"}}),a("h1",{staticClass:"mr-6"},[e._v("\n          Vehicles\n        ")]),a("vs-button",{staticClass:"mr-6 vs-con-loading__container ",attrs:{id:"loading"},on:{click:e.showVehicleForm}},[e._v("Add Vehicle")]),a("v-select",{staticClass:"mr-6",attrs:{clearable:!1,reduce:function(e){return e.id},options:e.availableDepots,label:"depot_name"},model:{value:e.selectedDepot,callback:function(t){e.selectedDepot=t},expression:"selectedDepot"}})],1)]),a("template",{slot:"thead"},[a("vs-th",[e._v(" Vehicle")]),a("vs-th",[e._v(" Type")]),a("vs-th",[e._v(" Staff")]),a("vs-th",[e._v("Status")]),a("vs-th",[e._v("Remove")])],1)],2)],1)},i=[],n=a("4a7a"),c=a.n(n),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vs-sidebar",{staticClass:"add-new-data-sidebar items-no-padding",attrs:{"click-not-close":"","position-right":"",parent:"body","default-index":"1",color:"primary",spacer:""},model:{value:e.isSidebarActiveLocal,callback:function(t){e.isSidebarActiveLocal=t},expression:"isSidebarActiveLocal"}},[a("div",{staticClass:"mt-6 flex items-center justify-between px-6"},[a("h4",[e._v("Vehicle Information")]),a("feather-icon",{staticClass:"cursor-pointer",attrs:{icon:"XIcon"},on:{click:function(t){t.stopPropagation(),e.isSidebarActiveLocal=!1}}})],1),a("vs-divider",{staticClass:"mb-0"}),a(e.scrollbarTag,{key:e.$vs.rtl,tag:"component",staticClass:"scroll-area--data-list-add-new",attrs:{settings:e.settings}},[a("div",{staticClass:"p-6"},[a("span",[e._v("Vehicle Type")]),a("v-select",{staticClass:" mb-5",attrs:{clearable:!1,options:e.vehicleTypes},model:{value:e.vehicleInstance.vehicle_type,callback:function(t){e.$set(e.vehicleInstance,"vehicle_type",t)},expression:"vehicleInstance.vehicle_type"}}),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mb-5 w-full",attrs:{label:"Vehicle Make",name:"make"},model:{value:e.vehicleInstance.make,callback:function(t){e.$set(e.vehicleInstance,"make",t)},expression:"vehicleInstance.make"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("make"),expression:"errors.has('make')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("make")))]),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mb-5 w-full",attrs:{label:"Vehicle Model",name:"model"},model:{value:e.vehicleInstance.model,callback:function(t){e.$set(e.vehicleInstance,"model",t)},expression:"vehicleInstance.model"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("model"),expression:"errors.has('model')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("model")))]),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mb-5 w-full",attrs:{label:"Licence Plate Number",name:"licence_plate_number"},model:{value:e.vehicleInstance.licence_plate_number,callback:function(t){e.$set(e.vehicleInstance,"licence_plate_number",t)},expression:"vehicleInstance.licence_plate_number"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("licence_plate_number"),expression:"errors.has('licence_plate_number')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("licence_plate_number")))]),a("span",[e._v("Default Depot")]),a("v-select",{staticClass:" mb-5",attrs:{clearable:!1,options:e.availableDepots,label:"depot_name"},model:{value:e.selectedDepot,callback:function(t){e.selectedDepot=t},expression:"selectedDepot"}}),a("span",[e._v("Assigned Staff")]),a("v-select",{staticClass:" mb-5",attrs:{clearable:!1,options:e.availableStaff,label:"staff_name"},model:{value:e.assignedStaff,callback:function(t){e.assignedStaff=t},expression:"assignedStaff"}}),a("span",[e._v("Vehicle Status")]),a("v-select",{staticClass:" mb-5",attrs:{clearable:!1,options:e.statusOptions},model:{value:e.vehicleInstance.vehicle_status,callback:function(t){e.$set(e.vehicleInstance,"vehicle_status",t)},expression:"vehicleInstance.vehicle_status"}})],1)]),a("div",{staticClass:"flex flex-wrap items-center p-6",attrs:{slot:"footer"},slot:"footer"},[a("vs-button",{staticClass:"mr-6",attrs:{disabled:!e.isFormValid},on:{click:function(t){return e.saveDepot()}}},[e._v("Submit")]),a("vs-button",{attrs:{type:"border",color:"danger"},on:{click:function(t){e.isSidebarActiveLocal=!1}}},[e._v("Cancel")])],1)],1)},o=[],r=(a("ac6a"),a("ffc1"),a("9d63")),d=a.n(r),f=a("bb36"),v={props:{isSidebarActive:{type:Boolean,required:!0},data:{type:Object,default:function(){}}},components:{VuePerfectScrollbar:d.a,vSelect:c.a},data:function(){return{vehicleInstance:{assigned_staff_id:"",default_depot_id:null,driver_id:"",vehicle_type:"",make:"",model:"",licence_plate_number:"",vehicle_status:"Active"},settings:{maxScrollbarLength:60,wheelSpeed:.6},availableDepots:[],selectedDepot:{id:null,depot_name:"Select Depot"},vehicleTypes:["Truck","Van","Motor Bike","TriCycle"],statusOptions:["Active","Out Of Service"],availableStaff:[],assignedStaff:{id:null,staff_name:"Select Staff"}}},watch:{isSidebarActive:function(e){var t=this;if(e)if(0===Object.entries(this.data).length)this.$validator.reset();else{this.vehicleInstance=this.data;var a=this.availableDepots.filter((function(e){return e.id==t.vehicleInstance.default_depot_id}));a.length>0&&(this.selectedDepot=a[0]);var s=this.availableStaff.filter((function(e){return e.id==t.vehicleInstance.assigned_staff_id}));a.length>0&&(this.assignedStaff=s[0])}}},computed:{isSidebarActiveLocal:{get:function(){return this.isSidebarActive},set:function(e){e||this.$emit("closeSidebar")}},isFormValid:function(){return!this.errors.any()},scrollbarTag:function(){return this.$store.getters.scrollbarTag}},methods:{saveDepot:function(){var e=this;console.log(JSON.stringify(this.vehicleInstance)),this.vehicleInstance.default_depot_id=this.selectedDepot.id,this.vehicleInstance.assigned_staff_id=this.assignedStaff.id,f["a"].post("/config/assets/vehicle/add",this.vehicleInstance).then((function(t){e.$vs.notify({title:"Success",text:"Vehicle Added",color:"success"}),e.vehicleInstance={},e.$emit("closeSidebar")})).catch((function(e){console.log(e)}))},fetchDepots:function(){var e=this;console.info("fetching depots.."),console.info(JSON.stringify(this.selectedDepot)),f["a"].get("/resources/assets/depots").then((function(t){e.availableDepots=t.data.payload.depots.data})).catch((function(e){console.log(e)}))},fetchStaff:function(){var e=this;console.info("fetching staff.."),console.info(JSON.stringify(this.selectedDepot)),f["a"].post("/resources/staff/get").then((function(t){e.availableStaff=t.data.payload.staff})).catch((function(e){console.log(e)}))}},created:function(){this.fetchDepots(),this.fetchStaff()}},u=v,h=(a("4625"),a("2877")),p=Object(h["a"])(u,l,o,!1,null,"c7ec1778",null),m=p.exports,b={components:{VehicleForm:m,vSelect:c.a},data:function(){return{selected:[],rawVehicles:[],depotInstance:null,itemsPerPage:100,isMounted:!1,addNewDataSidebar:!1,sidebarData:{},availableDepots:[],availableStaff:[],selectedDepot:{id:null,depot_name:"All Depots"}}},computed:{currentPage:function(){return this.isMounted?this.$refs.table.currentx:0},refinedVehicles:function(){return this.rawVehicles.map((function(e){return e}))}},methods:{fetchVehicles:function(e){var t=this;this.$vs.loading({background:this.backgroundLoading,container:"#loading",scale:.45}),console.info("fetching vehicles.."),f["a"].get("/resources/assets/vehicles?depot_id="+e).then((function(e){t.rawVehicles=e.data.payload.vehicles.data,t.$vs.loading.close("#loading > .con-vs-loading")})).catch((function(e){console.log(e)}))},confirmDepotDeletion:function(e){this.depotInstance=e,this.$vs.dialog({type:"confirm",color:"danger",title:"Confirm",text:"Are you sure you want to remove "+this.depotInstance.depot_name,accept:this.removeDepot})},removeDepot:function(){var e=this;this.$vs.loading({background:this.backgroundLoading,container:"#depotLoading",scale:.45}),f["a"].post("/config/assets/depot/remove",{id:this.depotInstance.id}).then((function(t){e.fetchVehicles()})).catch((function(t){console.log(t),e.$vs.loading.close("#depotLoading > .con-vs-loading")}))},showVehicleForm:function(){this.sidebarData={},this.toggleDataSidebar(!0)},editVehicle:function(e){this.sidebarData=e,this.toggleDataSidebar(!0)},toggleDataSidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.addNewDataSidebar=e,this.fetchVehicles()},fetchDepots:function(){var e=this;console.info("fetching depots.."),console.info(JSON.stringify(this.selectedDepot)),f["a"].get("/resources/assets/depots").then((function(t){e.availableDepots=t.data.payload.depots.data})).catch((function(e){console.log(e)}))},getOrderStatusColor:function(e){return"Active"===e?"success":"danger"}},watch:{selectedDepot:function(e){this.fetchVehicles(e)}},created:function(){},mounted:function(){this.fetchDepots(),this.fetchVehicles(),this.isMounted=!0}},g=b,_=(a("5f1a"),Object(h["a"])(g,s,i,!1,null,null,null));t["default"]=_.exports},4625:function(e,t,a){"use strict";a("6afd")},"5f1a":function(e,t,a){"use strict";a("6d74")},"6afd":function(e,t,a){},"6d74":function(e,t,a){}}]);
//# sourceMappingURL=chunk-464bf03b.06f46ed8.js.map