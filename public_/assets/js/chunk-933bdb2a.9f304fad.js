(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-933bdb2a"],{2567:function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));var a=s("41cb");function r(t){switch(t){case 400:return"Server could not understand the request";case 401:return"You have not logged in";case 402:return"Payment required";case 403:return"Resource is forbbidden";case 404:return"URL/Resource Not found";case 405:return"Request method not allowed";case 406:return"Not Acceptable";case 407:return"Proxy authentication required";case 408:return"Request timeout";case 413:return"Payload Too Large";case 415:return"Unsupported Media Type";case 413:return"Payload Too Large";case 422:return"Could not process request";case 429:return"Too Many Requests";case 500:return"Internal Server Error";case 504:return"Gateway Timeout";case 504:return"Network Authentication Required";default:return"Error Code:"+t}}function o(t){if(t.response){if(console.log(JSON.stringify(t.response.data.message)),401==t.response.status)return console.log("redirecting...."),a["a"].push("/login").catch((function(){})),"Not logged in";var e=t.response.data?t.response.data.message:t.response.message;return e+" -"+r(t.response.status)}return console.log(t),"An error occurred"}},"61a6":function(t,e,s){},8060:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"flex flex-wrap items-center mb-6"},[s("div",{staticClass:"flex-grow"},[s("div",{staticClass:"flex flex-wrap "},[s("h2",{staticClass:"font-bold",staticStyle:{"line-height":"48px !important",display:"flex","vertical-align":"middle !important"}},[s("vs-icon",{staticClass:"inline pt-2 mr-4",attrs:{size:"32px",icon:"view_quilt"}}),t._v("\n          Stock Requests\n        ")],1),s("v-select",{staticClass:"flex ml-4",attrs:{options:t.availableDepots,name:"depot_name",label:"depot_name",clearable:!1,placeholder:"Depot"},on:{input:function(e){return t.fetchStockRequests()}},model:{value:t.selectedDepot,callback:function(e){t.selectedDepot=e},expression:"selectedDepot"}}),s("vs-button",{staticClass:"py-0 ml-4",attrs:{icon:"refresh",type:"flat"},on:{click:function(e){return t.fetchStockRequests()}}},[t._v("Refresh")])],1)]),s("vs-button",{staticClass:"mr-4 vs-con-loading__container",attrs:{icon:"add",id:"customerLoading"},on:{click:t.showRequestForm}},[t._v("Request Stock\n    ")])],1),s("vx-card",[s("div",{staticClass:"px-6 py-6 rounded"},[s("vs-table",{attrs:{stripe:"",data:t.stockRequests},on:{selected:t.showRequestDetails},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return t._l(a,(function(e,r){return s("vs-tr",{key:r,attrs:{data:e}},[s("vs-td",[t._v("\n              "+t._s(a[r].staff?a[r].staff.staff_name:"Unknown Staff")+"\n            ")]),s("vs-td",[s("span",{staticStyle:{color:"#0d77e4","font-weight":"bold"}},[t._v(" "+t._s(a[r].created_at)+" ")])]),s("vs-td",[s("vs-chip",{attrs:{color:e.approved?"#cdf7ec":"#fff4f6"}},[s("span",{class:e.approved?"success-text":"danger-text",staticStyle:{"font-weight":"bold","margin-left":"4px"}},[t._v("\n                  "+t._s(e.approved?"Approved":e.rejected?"Rejected":"Not Approved")+"\n                 ")])])],1),s("vs-td",[s("vs-chip",{attrs:{color:e.dispatched?"#cdf7ec":"#f9eae4"}},[s("span",{class:e.dispatched?"success-text":"neutral-text",staticStyle:{"font-weight":"bold","margin-left":"4px"}},[t._v("\n                        "+t._s(e.dispatched?"Dispatched":"Not Dispatched")+"\n                ")])])],1)],1)}))}}]),model:{value:t.selectedRequest,callback:function(e){t.selectedRequest=e},expression:"selectedRequest"}},[s("template",{slot:"thead"},[s("vs-th",[t._v("Staff ")]),s("vs-th",[t._v(" Date ")]),s("vs-th",[t._v(" Approval ")]),s("vs-th",[t._v(" Dispatch Status ")])],1)],2)],1)]),s("vs-popup",{attrs:{fullscreen:"",title:"Request Stock",active:t.orderFormDialog},on:{close:function(e){return t.closeRequestForm()},"update:active":function(e){t.orderFormDialog=e}}},[s("div",{staticClass:"md:px-6"},[s("div",{staticClass:"vx-row"},[s("div",{staticClass:"vx-col md:w-1/3 w-1/4"},[s("div",{staticClass:"mx-6 px-6"},[s("h3",[t._v("Pick Product")]),s("div",{staticClass:"mt-4 mb-5"},[s("label",{staticClass:"vs-input--label"},[t._v("Product")]),s("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{clearable:!1,options:t.products,name:"Product",label:"product_name",placeholder:"Select"},on:{input:function(e){return t.fetchProductVariants()}},model:{value:t.selectedOrderProduct,callback:function(e){t.selectedOrderProduct=e},expression:"selectedOrderProduct"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("Product"),expression:"errors.has('Product')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("Product")))])],1),s("div",{staticClass:"mt-4 mb-5"},[s("label",{staticClass:"vs-input--label"},[t._v("Product Variant")]),s("v-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],attrs:{clearable:!1,options:t.productVariants,name:"Variant",label:"variant_name",placeholder:"Select"},model:{value:t.selectedOrderProductVariant,callback:function(e){t.selectedOrderProductVariant=e},expression:"selectedOrderProductVariant"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("Variant"),expression:"errors.has('Variant')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("Variant")))])],1),s("div",{staticClass:"mt-4 mb-5"},[s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full mt-4",attrs:{label:"Quantity",name:"quantity"},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("quantity"),expression:"errors.has('quantity')"}],staticClass:"text-danger text-sm"},[t._v("\n                 "+t._s(t.errors.first("quantity"))+" ")])],1),t.selectedOrderProduct&&t.selectedOrderProductVariant&&t.quantity>0?s("div",[s("vs-button",{ref:"saveButton",staticClass:"mr-4 mb-4",attrs:{color:"secondary"},on:{click:function(e){return t.addProductToCart()}}},[t._v("\n                Add to cart\n              ")])],1):t._e()])]),s("div",{staticClass:"vx-col md:w-1/3 w-1/4"},[s("h3",[t._v("Selected products")]),t._l(t.cartProducts,(function(e,a){return s("div",{key:a,staticClass:"category-itemm"},[s("vs-card",{staticClass:"my-6"},[s("div",{staticClass:"flex flex-wrap"},[s("p",{staticClass:"mt-1 flex-grow"},[t._v("\n                  "+t._s(e.product.product_name)+"\n                  "+t._s(e.productVariant.variant_name)+",\n                  QTY: "+t._s(e.quantity)+"\n                ")]),s("vs-button",{attrs:{type:"border",color:"danger",radius:"",icon:"close",size:"small"},on:{click:function(e){return t.removeFromCart(a)}}})],1)])],1)})),t.cartProducts.length>0?s("div",[s("vs-button",{ref:"saveButton",staticClass:"mr-4 mb-4",attrs:{color:"success"},on:{click:function(e){return t.submitRequest()}}},[t._v("\n              Submit Request\n            ")])],1):t._e()],2)]),s("div",{staticClass:"vx-row mt-12"},[s("div",{staticClass:"vx-col w-full"},[s("div",{staticClass:"flex items-start flex-col sm:flex-row"})])])])])],1)},r=[],o=s("bb36"),c=s("4a7a"),i=s.n(c),n=s("2567"),l={components:{vSelect:i.a},data:function(){return{stockRequests:[],productInstance:{id:null,product_name:null,vendor_id:1,is_published:!1,categories_ids:[]},productFormDialog:!1,placesVisible:!1,placesFormVisible:!1,placeInstance:{id:null,place_name:null,district_id:null},places:[],productCategoriesArray:[{title:"Main Category",id:null,selected_category:null,selected_category_id:null,sub_categories:[]}],availableVendors:[],selectedVendor:null,assignedCategories:[],productVariantsVisible:!1,availableCategories:[],selectedCategory:{category_name:"All Categories"},availableDepots:[],selectedDepot:{depot_name:"All Depots"},selectedRequest:{},orderFormDialog:!1,cartProducts:[],quantity:1,selectedOrderProduct:null,selectedOrderProductVariant:null,products:[],productVariants:[]}},methods:{fetchStockRequests:function(){var t=this;this.stockRequests=[];var e="/products/inventory/stock/requests?depot_id=";o["a"].get(e).then((function(e){t.stockRequests=e.data.payload.requests.data})).catch((function(t){console.log(t)}))},showRequestDetails:function(){this.$router.push({name:"products-inventory-stock-request-details",params:{selectedRequest:this.selectedRequest}})},closeProductForm:function(){this.productFormDialog=!1},showRequestForm:function(){this.orderFormDialog=!0},closeRequestForm:function(){this.orderFormDialog=!1},addProductToCart:function(){var t={product:this.selectedOrderProduct,productVariant:this.selectedOrderProductVariant,quantity:this.quantity};this.selectedOrderProduct=null,this.selectedOrderProductVariant=null,this.quantity=1,this.cartProducts.push(t)},removeFromCart:function(t){console.log(t),this.cartProducts.splice(t,1)},submitRequest:function(){var t=this,e=this.cartProducts.map((function(t){return{variant_id:t.productVariant.id,quantity:t.quantity}})),s={depot_id:null,product_variants:e};console.log(JSON.stringify(s)),o["a"].post("/products/inventory/stock/request",s).then((function(e){t.closeRequestForm(),t.happilyNotify("Request Sent"),t.fetchStockRequests()})).catch((function(e){console.log(e),t.handleApiError(e)}))},closeProductVariantsDialog:function(){this.productVariantsVisible=!1,this.fetchStockRequests()},showProductVariants:function(t){this.productInstance=t,this.productVariantsVisible=!0},getAvailableCategories:function(t){var e=this,s=this.productCategoriesArray[t].id;o["a"].get("/resources/products/categories?parent_id="+s).then((function(s){e.productCategoriesArray[t].sub_categories=s.data.payload.categories})).catch((function(t){console.log(t)}))},fetchSubCategories:function(t){var e=this;o["a"].get("/resources/products/categories?parent_id="+t.selected_category.id).then((function(s){var a=s.data.payload.categories;if(a.length>0){console.log("Has sub categories");var r={};r.id=t.id,r.title=t.selected_category.category_name,r.selected_category_id=t.null,r.sub_categories=a,e.productCategoriesArray.push(r)}})).catch((function(t){console.log(t)}))},fetchAvailableCategories:function(){var t=this;o["a"].get("/resources/products/categories/all").then((function(e){t.availableCategories=e.data.payload.categories,t.availableCategories.push(t.selectedCategory)})).catch((function(t){console.log(t)}))},fetchAvailableVendors:function(){var t=this;o["a"].get("/resources/products/vendors/all").then((function(e){t.availableVendors=e.data.payload.vendors})).catch((function(t){console.log(t)}))},fetchAvailableDepots:function(){var t=this;console.info("fetching depots.."),console.info(JSON.stringify(this.selectedDepot)),o["a"].get("/resources/assets/depots").then((function(e){t.availableDepots=e.data.payload.depots.data,t.availableDepots.push(t.selectedDepot),t.selectedDepot=t.availableDepots[0]})).catch((function(t){console.log(t)}))},fetchProducts:function(){var t=this;o["a"].get("/resources/products/products?category_id=").then((function(e){t.products=e.data.payload.products.data})).catch((function(t){console.log(t)}))},fetchProductVariants:function(){var t=this;this.productVariants=[],this.selectedOrderProductVariant=null,o["a"].get("/resources/product/variants?product_id="+this.selectedOrderProduct.id).then((function(e){t.productVariants=e.data.payload.product_variants})).catch((function(e){console.log(e),t.handleApiError(e)}))},handleApiError:function(t){this.$vs.notify({title:"Error",text:Object(n["a"])(t),iconPack:"feather",icon:"icon-alert-circle",color:"danger"})},happilyNotify:function(t){this.$vs.notify({title:"Success",text:t,color:"success"})},sadlyNotify:function(t){this.$vs.notify({title:"Error",text:t,color:"danger",position:"bottom-left"})}},created:function(){this.getAvailableCategories(0),this.fetchAvailableVendors(),this.fetchAvailableCategories(),this.fetchAvailableDepots(),this.fetchProducts()},mounted:function(){this.fetchStockRequests()}},d=l,u=(s("9d64"),s("2877")),p=Object(u["a"])(d,a,r,!1,null,"83eecaba",null);e["default"]=p.exports},"9d64":function(t,e,s){"use strict";s("61a6")}}]);
//# sourceMappingURL=chunk-933bdb2a.9f304fad.js.map