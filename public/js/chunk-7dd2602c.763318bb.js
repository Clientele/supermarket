(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dd2602c"],{"37f4":function(e,t,s){"use strict";s("cb6b")},"4630f":function(e,t,s){"use strict";s("8fcd")},"52c3":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"data-list-container",attrs:{id:"data-list-list-view"}},[s("depot-form",{attrs:{isSidebarActive:e.addNewDataSidebar,data:e.sidebarData},on:{closeSidebar:e.toggleDataSidebar}}),s("vs-table",{ref:"table",attrs:{multiple:"",pagination:"","max-items":e.itemsPerPage,search:"",data:e.refinedDepots},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return[s("tbody",e._l(a,(function(t,a){return s("vs-tr",{key:a,attrs:{data:t}},[s("vs-td",[s("p",{staticClass:"product-name font-medium truncate"},[e._v(e._s(t.depot_name))])]),s("vs-td",[s("p",{staticClass:"product-category"},[e._v(e._s(e._f("title")(t.location_name))+" ")])]),s("vs-td",{staticClass:"whitespace-no-wrap"},[s("vs-button",{staticClass:"mr-2",attrs:{color:"secondary",size:"small",type:"border"},on:{click:function(s){return e.editData(t)}}},[e._v("Edit")])],1),s("vs-td",{staticClass:"whitespace-no-wrap"},[s("vs-button",{attrs:{color:"danger",size:"small",type:"border"},on:{click:function(s){return e.confirmDepotDeletion(t)}}},[e._v("Delete")])],1)],1)})),1)]}}]),model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[s("div",{staticClass:"flex flex-wrap-reverse items-center flex-grow justify-between",attrs:{slot:"header"},slot:"header"},[s("div",{staticClass:"flex flex-wrap-reverse items-center data-list-btn-container"},[s("vs-icon",{staticClass:"mr-2",attrs:{icon:"home_work",size:"large",color:"primary"}}),s("h1",{staticClass:"mr-6"},[e._v("\n          Depots\n        ")]),s("vs-button",{staticClass:"mr-4 vs-con-loading__container",attrs:{icon:"add",id:"depotLoading",type:"border"},on:{click:e.addNewData}},[e._v("Add Depot")]),s("v-select",{staticClass:"mr-6",attrs:{clearable:!1,reduce:function(e){return e.id},options:e.availableRegions,label:"region_name"},model:{value:e.selectedRegionId,callback:function(t){e.selectedRegionId=t},expression:"selectedRegionId"}})],1)]),s("template",{slot:"thead"},[s("vs-th",{attrs:{"sort-key":"name"}},[e._v("Name")]),s("vs-th",{attrs:{"sort-key":"category"}},[e._v("Location")]),s("vs-th",[e._v("Edit")]),s("vs-th",[e._v("Remove")])],1)],2)],1)},i=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("vs-sidebar",{staticClass:"add-new-data-sidebar items-no-padding",attrs:{"click-not-close":"","position-right":"",parent:"body","default-index":"1",color:"primary",spacer:""},model:{value:e.isSidebarActiveLocal,callback:function(t){e.isSidebarActiveLocal=t},expression:"isSidebarActiveLocal"}},[s("div",{staticClass:"mt-6 flex items-center justify-between px-6"},[s("h4",[e._v("Depot Information")]),s("feather-icon",{staticClass:"cursor-pointer",attrs:{icon:"XIcon"},on:{click:function(t){t.stopPropagation(),e.isSidebarActiveLocal=!1}}})],1),s("vs-divider",{staticClass:"mb-0"}),s(e.scrollbarTag,{key:e.$vs.rtl,tag:"component",staticClass:"scroll-area--data-list-add-new",attrs:{settings:e.settings}},[s("div",{staticClass:"p-6"},[s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"Depot Name",name:"name"},model:{value:e.depotInstance.depot_name,callback:function(t){e.$set(e.depotInstance,"depot_name",t)},expression:"depotInstance.depot_name"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("item-name"),expression:"errors.has('item-name')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("name")))]),e.selectedAddress?e._e():s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"Location",name:"location"},model:{value:e.locationQuery,callback:function(t){e.locationQuery=t},expression:"locationQuery"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("location"),expression:"errors.has('location')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("item-name")))]),e._l(e.addresses,(function(t,a){return s("div",{key:a,staticClass:"location-item px-2 py-2 rounded mt-4",on:{click:function(s){return e.pickAddress(t)}}},[s("ul",[s("li",[e._v(e._s(t.location_name)+" ")])])])})),e.selectedAddress?s("div",{staticClass:"mt-4"},[s("span",{staticClass:" text-sm"},[e._v("Depot Location")])]):e._e(),e.selectedAddress?s("div",{staticClass:"selected-address px-2 py-2 rounded mt-4"},[s("div",{staticClass:"flex flex-wrap items-center"},[s("div",{staticClass:"flex-grow"},[e._v("\n            "+e._s(e.selectedAddress.location_name)+"\n          ")]),s("vs-button",{attrs:{color:"danger",type:"flat","icon-pack":"feather",icon:"icon-x"},on:{click:function(t){return e.removeAddress()}}})],1)]):e._e()],2)]),s("div",{staticClass:"flex flex-wrap items-center p-6",attrs:{slot:"footer"},slot:"footer"},[s("vs-button",{staticClass:"mr-6",attrs:{disabled:!e.isFormValid},on:{click:function(t){return e.saveDepot()}}},[e._v("Submit")]),s("vs-button",{attrs:{type:"border",color:"danger"},on:{click:function(t){e.isSidebarActiveLocal=!1}}},[e._v("Cancel")])],1)],1)},o=[],r=(s("ac6a"),s("ffc1"),s("9d63")),c=s.n(r),d=s("bb36"),l={props:{isSidebarActive:{type:Boolean,required:!0},data:{type:Object,default:function(){}}},components:{VuePerfectScrollbar:c.a},data:function(){return{locationQuery:"",locationSearchDialog:!1,searchTerm:"",addressesRawResults:[],selectedAddress:null,depotInstance:{depot_name:"",country_id:"",zone_id:"",region_id:"",district_id:"",place_id:""},settings:{maxScrollbarLength:60,wheelSpeed:.6}}},watch:{isSidebarActive:function(e){e&&(0===Object.entries(this.data).length?this.$validator.reset():(this.depotInstance=this.data,this.selectedAddress={},this.selectedAddress.location_name=this.data.location_name,this.selectedAddress.country_id=this.data.country_id,this.selectedAddress.zone_id=this.data.zone_id,this.selectedAddress.region_id=this.data.region_id,this.selectedAddress.district_id=this.data.district_id,this.selectedAddress.place_id=this.data.place_id))},locationQuery:function(e){this.searchLocations()}},computed:{isSidebarActiveLocal:{get:function(){return this.isSidebarActive},set:function(e){e||this.$emit("closeSidebar")}},isFormValid:function(){return!this.errors.any()},scrollbarTag:function(){return this.$store.getters.scrollbarTag},addresses:function(){return this.addressesRawResults.map((function(e){var t={};return"places"===e.type&&(t.location_name=e.searchable.place_name,t.place_id=e.searchable.id),"districts"===e.type&&(t.location_name=e.searchable.district_name,t.district_id=e.searchable.id),"regions"===e.type&&(t.location_name=e.searchable.region_name,t.region_id=e.searchable.id),e.searchable.place&&(t.location_name=t.location_name+" "+e.searchable.district.district_name,t.place_id=e.searchable.id),e.searchable.district&&(t.location_name=t.location_name+" "+e.searchable.district.district_name,t.district_id=e.searchable.district.id),e.searchable.region&&(t.location_name=t.location_name+" "+e.searchable.region.region_name,t.region_id=e.searchable.region.id),e.searchable.country&&(t.location_name=t.location_name+" "+e.searchable.region.region_name,t.country_id=e.searchable.country.id),t}))}},methods:{pickAddress:function(e){this.addressesRawResults=[],this.selectedAddress=e},removeAddress:function(){this.selectedAddress=null},saveDepot:function(){var e=this;null!=this.selectedAddress?(this.depotInstance.country_id=this.selectedAddress.country_id,this.depotInstance.region_id=this.selectedAddress.region_id,this.depotInstance.district_id=this.selectedAddress.district_id,this.depotInstance.place_id=this.selectedAddress.place_id,d["a"].post("/config/assets/depot/add",this.depotInstance).then((function(t){e.$vs.notify({title:"Success",text:"Depot Added",color:"success"}),e.depotInstance={},e.selectedAddress=null,e.$emit("closeSidebar")})).catch((function(e){console.log(e)}))):this.$vs.notify({title:"Alert",text:"Select Address",color:"danger"})},searchLocations:function(){var e=this;this.addressesRawResults=[],this.locationQuery&&d["a"].post("/resources/addresses/find",{query:this.locationQuery}).then((function(t){t.data.success&&(e.addressesRawResults=t.data.payload.addresses)})).catch((function(e){console.log(e)}))}}},u=l,p=(s("4630f"),s("2877")),h=Object(p["a"])(u,n,o,!1,null,"8b0f82fa",null),f=h.exports,m=s("4a7a"),v=s.n(m),g={components:{DepotForm:f,vSelect:v.a},data:function(){return{selected:[],rawDepots:[],depotInstance:null,itemsPerPage:4,isMounted:!1,addNewDataSidebar:!1,sidebarData:{},selectedRegionId:{id:null,region_name:"All Regions"},availableRegions:[]}},computed:{currentPage:function(){return this.isMounted?this.$refs.table.currentx:0},refinedDepots:function(){return this.rawDepots.map((function(e){var t="";return t=e.place?e.place.place_name:"",t=e.district?t+" "+e.district.district_name:t,t=e.region?t+" "+e.region.region_name:t,e.location_name=t,e}))}},methods:{fetchDepots:function(){var e=this;console.log(JSON.stringify(this.selectedRegionId)),this.rawDepots=[],this.$vs.loading({background:this.backgroundLoading,container:"#depotLoading",scale:.45}),console.info("fetching depots.."),d["a"].get("/resources/assets/depots?region_id="+this.selectedRegionId).then((function(t){e.rawDepots=t.data.payload.depots.data,e.$vs.loading.close("#depotLoading > .con-vs-loading")})).catch((function(e){console.log(e)}))},confirmDepotDeletion:function(e){this.depotInstance=e,this.$vs.dialog({type:"confirm",color:"danger",title:"Confirm",text:"Are you sure you want to remove "+this.depotInstance.depot_name,accept:this.removeDepot})},removeDepot:function(){var e=this;this.$vs.loading({background:this.backgroundLoading,container:"#depotLoading",scale:.45}),d["a"].post("/config/assets/depot/remove",{id:this.depotInstance.id}).then((function(t){e.fetchDepots()})).catch((function(t){console.log(t),e.$vs.loading.close("#depotLoading > .con-vs-loading")}))},addNewData:function(){this.sidebarData={},this.toggleDataSidebar(!0)},editData:function(e){this.sidebarData=e,this.toggleDataSidebar(!0)},getOrderStatusColor:function(e){return"on_hold"===e?"warning":"delivered"===e?"success":"canceled"===e?"danger":"primary"},getPopularityColor:function(e){return e>90?"success":e>70?"primary":e>=50?"warning":e<50?"danger":"primary"},toggleDataSidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.addNewDataSidebar=e,this.fetchDepots()},fetchRegions:function(){var e=this;console.info("fetching regions.."),console.info(JSON.stringify(this.selectedDepot)),d["a"].get("/resources/addresses/regions?country_id=1").then((function(t){e.availableRegions=t.data.payload.regions,e.availableRegions.unshift({id:null,region_name:"All Regions"})})).catch((function(e){console.log(e)}))}},watch:{selectedRegionId:function(e){this.fetchDepots()}},created:function(){this.fetchRegions()},mounted:function(){this.fetchDepots(),this.isMounted=!0}},_=g,b=(s("37f4"),Object(p["a"])(_,a,i,!1,null,null,null));t["default"]=b.exports},"8fcd":function(e,t,s){},cb6b:function(e,t,s){}}]);
//# sourceMappingURL=chunk-7dd2602c.763318bb.js.map