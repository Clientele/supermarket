(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-19012ad8"],{1295:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"data-list-container",attrs:{id:"data-list-list-view"}},[s("customer-form",{attrs:{isSidebarActive:e.showCustomerFormSidebar,data:e.sidebarData},on:{closeSidebar:e.toggleDataSidebar}}),s("vs-table",{ref:"table",attrs:{pagination:"","max-items":e.itemsPerPage,search:"",data:e.refinedCustomers},on:{selected:function(t){return e.showCustomerDetails()}},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return[s("tbody",e._l(a,(function(t,a){return s("vs-tr",{key:a,attrs:{data:t}},[s("vs-td",[s("p",{staticClass:"product-name font-medium truncate"},[e._v(e._s(t.customer_name))])]),s("vs-td",[s("p",{staticClass:"product-category"},[e._v(e._s(e._f("title")(t.location_name))+" ")])]),s("vs-td",{staticClass:"whitespace-no-wrap"},[s("vs-button",{staticClass:"mr-2",attrs:{color:"secondary",size:"small",type:"border"},on:{click:function(s){return e.editData(t)}}},[e._v("Edit")])],1),s("vs-td",{staticClass:"whitespace-no-wrap"},[s("vs-button",{attrs:{color:"danger",size:"small",type:"border"},on:{click:function(s){return e.confirmCustomerDeletion(t)}}},[e._v("Delete")])],1)],1)})),1)]}}]),model:{value:e.selectedCustomer,callback:function(t){e.selectedCustomer=t},expression:"selectedCustomer"}},[s("div",{staticClass:"flex flex-wrap-reverse items-center flex-grow justify-between",attrs:{slot:"header"},slot:"header"},[s("div",{staticClass:"flex flex-wrap-reverse items-center data-list-btn-container"},[s("vs-icon",{staticClass:"mr-2",attrs:{icon:"groups",size:"large",color:"primary"}}),s("h1",{staticClass:"mr-6"},[e._v("\n          Customers\n        ")]),s("v-select",{staticClass:"mr-6",attrs:{clearable:!1,reduce:function(e){return e.id},options:e.availableRegions,label:"region_name"},model:{value:e.selectedRegionId,callback:function(t){e.selectedRegionId=t},expression:"selectedRegionId"}}),s("vs-button",{staticClass:"mr-4 vs-con-loading__container",attrs:{icon:"add",id:"customerLoading"},on:{click:e.showCustomerForm}},[e._v("Add Customer")])],1)]),s("template",{slot:"thead"},[s("vs-th",{attrs:{"sort-key":"name"}},[e._v("Name")]),s("vs-th",{attrs:{"sort-key":"category"}},[e._v("Location")]),s("vs-th",[e._v("Action")]),s("vs-th",[e._v("Action ")])],1)],2)],1)},r=[],n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("vs-sidebar",{staticClass:"add-new-data-sidebar items-no-padding",attrs:{"click-not-close":"","position-right":"",parent:"body","default-index":"1",color:"primary",spacer:""},model:{value:e.isSidebarActiveLocal,callback:function(t){e.isSidebarActiveLocal=t},expression:"isSidebarActiveLocal"}},[s("div",{staticClass:"mt-6 flex items-center justify-between px-6"},[s("h4",[e._v("Customer Information")]),s("feather-icon",{staticClass:"cursor-pointer",attrs:{icon:"XIcon"},on:{click:function(t){t.stopPropagation(),e.isSidebarActiveLocal=!1}}})],1),s("vs-divider",{staticClass:"mb-0"}),s(e.scrollbarTag,{key:e.$vs.rtl,tag:"component",staticClass:"scroll-area--data-list-add-new",attrs:{settings:e.settings}},[s("div",{staticClass:"p-6"},[s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"Customer Name",name:"name"},model:{value:e.customerInstance.customer_name,callback:function(t){e.$set(e.customerInstance,"customer_name",t)},expression:"customerInstance.customer_name"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("item-name"),expression:"errors.has('item-name')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("name")))]),s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"Email Address",name:"email"},model:{value:e.customerInstance.email,callback:function(t){e.$set(e.customerInstance,"email",t)},expression:"customerInstance.email"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("email"),expression:"errors.has('email')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("email")))]),s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"Phone 1",name:"phone_number_1"},model:{value:e.customerInstance.phone_number_1,callback:function(t){e.$set(e.customerInstance,"phone_number_1",t)},expression:"customerInstance.phone_number_1"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("phone_number_1"),expression:"errors.has('phone_number_1')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("phone_number_1")))]),s("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"Phone 2",name:"phone_number_1"},model:{value:e.customerInstance.phone_number_2,callback:function(t){e.$set(e.customerInstance,"phone_number_2",t)},expression:"customerInstance.phone_number_2"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("phone_number_2"),expression:"errors.has('phone_number_2')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("phone_number_2")))]),e.selectedAddress?e._e():s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"Location",name:"location"},model:{value:e.locationQuery,callback:function(t){e.locationQuery=t},expression:"locationQuery"}}),s("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("location"),expression:"errors.has('location')"}],staticClass:"text-danger text-sm"},[e._v(e._s(e.errors.first("item-name")))]),e._l(e.addresses,(function(t,a){return s("div",{key:a,staticClass:"location-item px-2 py-2 rounded mt-4",on:{click:function(s){return e.pickAddress(t)}}},[s("ul",[s("li",[e._v(e._s(t.location_name)+" ")])])])})),e.selectedAddress?s("div",{staticClass:"mt-4"},[s("span",{staticClass:" text-sm"},[e._v("Depot Location")])]):e._e(),e.selectedAddress?s("div",{staticClass:"selected-address px-2 py-2 rounded mt-4"},[s("div",{staticClass:"flex flex-wrap items-center"},[s("div",{staticClass:"flex-grow"},[e._v("\n            "+e._s(e.selectedAddress.location_name)+"\n          ")]),s("vs-button",{attrs:{color:"danger",type:"flat","icon-pack":"feather",icon:"icon-x"},on:{click:function(t){return e.removeAddress()}}})],1)]):e._e()],2)]),s("div",{staticClass:"flex flex-wrap items-center p-6",attrs:{slot:"footer"},slot:"footer"},[s("vs-button",{staticClass:"mr-6",attrs:{disabled:!e.isFormValid},on:{click:function(t){return e.saveCustomer()}}},[e._v("Submit")]),s("vs-button",{attrs:{type:"border",color:"danger"},on:{click:function(t){e.isSidebarActiveLocal=!1}}},[e._v("Cancel")])],1)],1)},i=[],o=(s("ac6a"),s("ffc1"),s("9d63")),c=s.n(o),l=s("bb36"),d=s("2567"),u={props:{isSidebarActive:{type:Boolean,required:!0},data:{type:Object,default:function(){}}},components:{VuePerfectScrollbar:c.a},data:function(){return{locationQuery:"",locationSearchDialog:!1,searchTerm:"",addressesRawResults:[],selectedAddress:null,customerInstance:{customer_name:"",email:"",phone_number_1:"",phone_number_2:"",country_id:"",zone_id:"",region_id:"",district_id:"",place_id:""},settings:{maxScrollbarLength:60,wheelSpeed:.6}}},watch:{isSidebarActive:function(e){e&&(0===Object.entries(this.data).length?this.$validator.reset():(this.customerInstance=this.data,this.selectedAddress={},this.selectedAddress.location_name=this.data.location_name,this.selectedAddress.country_id=this.data.country_id,this.selectedAddress.zone_id=this.data.zone_id,this.selectedAddress.region_id=this.data.region_id,this.selectedAddress.district_id=this.data.district_id,this.selectedAddress.place_id=this.data.place_id))},locationQuery:function(e){this.searchLocations()}},computed:{isSidebarActiveLocal:{get:function(){return this.isSidebarActive},set:function(e){e||this.$emit("closeSidebar")}},isFormValid:function(){return!this.errors.any()},scrollbarTag:function(){return this.$store.getters.scrollbarTag},addresses:function(){return this.addressesRawResults.map((function(e){var t={};return"places"===e.type&&(t.location_name=e.searchable.place_name,t.place_id=e.searchable.id),"districts"===e.type&&(t.location_name=e.searchable.district_name,t.district_id=e.searchable.id),"regions"===e.type&&(t.location_name=e.searchable.region_name,t.region_id=e.searchable.id),e.searchable.place&&(t.location_name=t.location_name+" "+e.searchable.district.district_name,t.place_id=e.searchable.id),e.searchable.district&&(t.location_name=t.location_name+" "+e.searchable.district.district_name,t.district_id=e.searchable.district.id),e.searchable.region&&(t.location_name=t.location_name+" "+e.searchable.region.region_name,t.region_id=e.searchable.region.id),e.searchable.country&&(t.location_name=t.location_name+" "+e.searchable.region.region_name,t.country_id=e.searchable.country.id),t}))}},methods:{pickAddress:function(e){this.addressesRawResults=[],this.selectedAddress=e},removeAddress:function(){this.selectedAddress=null},saveCustomer:function(){var e=this;null!=this.selectedAddress?(this.customerInstance.country_id=this.selectedAddress.country_id,this.customerInstance.region_id=this.selectedAddress.region_id,this.customerInstance.district_id=this.selectedAddress.district_id,this.customerInstance.place_id=this.selectedAddress.place_id,console.log(JSON.stringify(this.customerInstance)),l["a"].post("/sales/customer/add",this.customerInstance).then((function(t){e.happilyNotify("Customer Updated"),e.customerInstance={},e.selectedAddress=null,e.$emit("closeSidebar")})).catch((function(t){console.log(t),e.handleApiError(t)}))):this.$vs.notify({title:"Alert",text:"Select Address",color:"danger"})},searchLocations:function(){var e=this;this.addressesRawResults=[],this.locationQuery&&l["a"].post("/resources/addresses/find",{query:this.locationQuery}).then((function(t){t.data.success&&(e.addressesRawResults=t.data.payload.addresses)})).catch((function(e){console.log(e)}))},handleApiError:function(e){this.$vs.notify({title:"Error",text:Object(d["a"])(e),iconPack:"feather",icon:"icon-alert-circle",color:"danger"})},happilyNotify:function(e){this.$vs.notify({title:"Success",text:e,color:"success"})}}},m=u,h=(s("710a"),s("2877")),v=Object(h["a"])(m,n,i,!1,null,"050d38b0",null),f=v.exports,p=s("4a7a"),_=s.n(p),g={components:{CustomerForm:f,vSelect:_.a},data:function(){return{selected:[],rawCustomers:[],customerInstance:null,itemsPerPage:4,isMounted:!1,selectedCustomer:null,showCustomerFormSidebar:!1,sidebarData:{},selectedRegionId:{id:null,region_name:"All Regions"},availableRegions:[]}},computed:{currentPage:function(){return this.isMounted?this.$refs.table.currentx:0},refinedCustomers:function(){return this.rawCustomers.map((function(e){var t="";return t=e.place?e.place.place_name:"",t=e.district?t+" "+e.district.district_name:t,t=e.region?t+" "+e.region.region_name:t,e.location_name=t,e}))}},methods:{fetchCustomers:function(){var e=this;console.log(JSON.stringify(this.selectedRegionId)),this.rawCustomers=[],this.$vs.loading({background:this.backgroundLoading,container:"#customerLoading",scale:.45}),console.info("fetching customers.."),l["a"].get("/resources/sales/customers?region_id="+this.selectedRegionId).then((function(t){e.rawCustomers=t.data.payload.customers.data,e.$vs.loading.close("#customerLoading > .con-vs-loading")})).catch((function(t){console.log(t),e.handleApiError(t)}))},confirmCustomerDeletion:function(e){this.customerInstance=e,this.$vs.dialog({type:"confirm",color:"danger",title:"Confirm",text:"Are you sure you want to remove "+this.customerInstance.customer_name,accept:this.removeCustomer})},removeCustomer:function(){var e=this;this.$vs.loading({background:this.backgroundLoading,container:"#customerLoading",scale:.45}),l["a"].post("/sales/customer/remove",{id:this.customerInstance.id}).then((function(t){e.fetchCustomers(),e.happilyNotify("Customer removed")})).catch((function(t){console.log(t),e.$vs.loading.close("#customerLoading > .con-vs-loading"),e.handleApiError(t)}))},showCustomerForm:function(){this.sidebarData={},this.toggleDataSidebar(!0)},editData:function(e){this.sidebarData=e,this.toggleDataSidebar(!0)},toggleDataSidebar:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.showCustomerFormSidebar=e,this.fetchCustomers()},showCustomerDetails:function(){!0!==this.showCustomerFormSidebar&&this.$router.push({name:"sales-customer-details",params:{customerId:this.selectedCustomer.id}})},fetchRegions:function(){var e=this;console.info("fetching regions.."),console.info(JSON.stringify(this.selectedCustomer)),l["a"].get("/resources/addresses/regions?country_id=1").then((function(t){e.availableRegions=t.data.payload.regions,e.availableRegions.unshift({id:null,region_name:"All Regions"})})).catch((function(e){console.log(e)}))},handleApiError:function(e){this.$vs.notify({title:"Error",text:Object(d["a"])(e),iconPack:"feather",icon:"icon-alert-circle",color:"danger"})},happilyNotify:function(e){this.$vs.notify({title:"Success",text:e,color:"success"})}},watch:{selectedRegionId:function(e){this.fetchCustomers()}},created:function(){this.fetchRegions()},mounted:function(){this.fetchCustomers(),this.isMounted=!0}},b=g,C=(s("1513"),Object(h["a"])(b,a,r,!1,null,null,null));t["default"]=C.exports},1513:function(e,t,s){"use strict";s("3247")},2567:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s("41cb");function r(e){switch(e){case 400:return"Server could not understand the request";case 401:return"You have not logged in";case 402:return"Payment required";case 403:return"Resource is forbbidden";case 404:return"URL/Resource Not found";case 405:return"Request method not allowed";case 406:return"Not Acceptable";case 407:return"Proxy authentication required";case 408:return"Request timeout";case 413:return"Payload Too Large";case 415:return"Unsupported Media Type";case 413:return"Payload Too Large";case 422:return"Could not process request";case 429:return"Too Many Requests";case 500:return"Internal Server Error";case 504:return"Gateway Timeout";case 504:return"Network Authentication Required";default:return"Error Code:"+e}}function n(e){if(e.response){if(console.log(JSON.stringify(e.response.data.message)),401==e.response.status)return console.log("redirecting...."),a["a"].push("/login").catch((function(){})),"Not logged in";var t=e.response.data?e.response.data.message:e.response.message;return t+" -"+r(e.response.status)}return console.log(e),"An error occurred"}},3247:function(e,t,s){},"4c3e":function(e,t,s){},"710a":function(e,t,s){"use strict";s("4c3e")}}]);
//# sourceMappingURL=chunk-19012ad8.3a5ae8a6.js.map