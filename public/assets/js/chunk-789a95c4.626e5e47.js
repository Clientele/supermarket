(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-789a95c4"],{2567:function(t,e,s){"use strict";s.d(e,"a",(function(){return c}));var o=s("41cb");function a(t){switch(t){case 400:return"Server could not understand the request";case 401:return"You have not logged in";case 402:return"Payment required";case 403:return"Resource is forbbidden";case 404:return"URL/Resource Not found";case 405:return"Request method not allowed";case 406:return"Not Acceptable";case 407:return"Proxy authentication required";case 408:return"Request timeout";case 413:return"Payload Too Large";case 415:return"Unsupported Media Type";case 413:return"Payload Too Large";case 422:return"Could not process request";case 429:return"Too Many Requests";case 500:return"Internal Server Error";case 504:return"Gateway Timeout";case 504:return"Network Authentication Required";default:return"Error Code:"+t}}function c(t){if(t.response){if(console.log(JSON.stringify(t.response.data.message)),401==t.response.status)return console.log("redirecting...."),o["a"].push("/login").catch((function(){})),"Not logged in";var e=t.response.data?t.response.data.message:t.response.message;return e+" -"+a(t.response.status)}return console.log(t),"An error occurred"}},"3d67":function(t,e,s){"use strict";s("487e")},"487e":function(t,e,s){},b2df:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"flex flex-wrap items-center mb-6"},[s("div",{staticClass:"flex-grow"},[s("div",{staticClass:"flex flex-wrap "},[s("h2",{staticClass:"font-bold",staticStyle:{"line-height":"48px !important",display:"flex","vertical-align":"middle !important"}},[s("vs-icon",{staticClass:"inline pt-2 mr-4",attrs:{size:"32px",icon:"subject"}}),t._v("\n          Request Details\n        ")],1)])]),t.stockRequest.approved?s("vs-chip",{attrs:{color:"success"}},[t._v("Approved")]):s("vs-button",{attrs:{color:"secondary"},on:{click:function(e){return t.approveRequest()}}},[t._v("Approve")])],1),s("vx-card",[s("div",{staticClass:"px-6 py-6 rounded"},[s("div",{staticClass:"flex flex-wrap "},[s("h4",{staticStyle:{"line-height":"48px !important",display:"flex","vertical-align":"middle !important"}},[s("vs-icon",{staticClass:"inline pt-2 mr-4",attrs:{size:"32px",icon:"person"}}),t._v("\n          "+t._s(t.selectedRequest.staff?t.selectedRequest.staff.staff_name:"Unknown Staff")+"\n        ")],1)]),s("vs-table",{attrs:{stripe:"",data:t.stockRequest.request_products},on:{selected:function(e){return t.showDispatchForm()}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.data;return t._l(o,(function(e,o){return s("vs-tr",{key:o,attrs:{data:e}},[s("vs-td",[t._v("\n              "+t._s(e.product?e.product.product_name:"No Product Name")+"\n            ")]),s("vs-td",[t._v("\n              "+t._s(e.variant?e.variant.variant_name:"No Name")+"\n            ")]),s("vs-td",[t._v("\n              "+t._s(e.quantity)+"\n            ")]),s("vs-td",[s("vs-chip",{attrs:{color:(e.approved,"#cdf7ec")}},[s("span",{class:(e.approved,"success-text"),staticStyle:{"font-weight":"bold","margin-left":"4px"}},[t._v("\n                  "+t._s(e.dispatched_quantity)+"\n                 ")])])],1),s("vs-td",[s("vs-chip",{attrs:{color:e.quantity-e.dispatched_quantity<=0?"#cdf7ec":"#fff4f6"}},[s("span",{class:e.quantity-e.dispatched_quantity<=0?"success-text":"danger-text",staticStyle:{"font-weight":"bold","margin-left":"4px"}},[t._v("\n                  "+t._s(e.quantity-e.dispatched_quantity)+"\n                 ")])])],1)],1)}))}}]),model:{value:t.selectedStockRequestProduct,callback:function(e){t.selectedStockRequestProduct=e},expression:"selectedStockRequestProduct"}},[s("template",{slot:"thead"},[s("vs-th",[t._v("Product ")]),s("vs-th",[t._v("Variant ")]),s("vs-th",[t._v("Requested  ")]),s("vs-th",[t._v("Dispatched ")]),s("vs-th",[t._v("Remaining ")])],1)],2)],1),s("vs-prompt",{attrs:{title:"Dispatch","accept-text":"Dispatch","cancel-text":"Cancel",color:"#118ab2",active:t.dispatchFormDialog},on:{cancel:function(e){t.selectedDepotProduct=null},accept:function(e){return t.dispatchProduct()},"update:active":function(e){t.dispatchFormDialog=e}}},[t.selectedDepotProduct?s("h4",{staticClass:"my-6"},[t._v("Quantity to dispatch")]):s("h4",{staticClass:"my-6"},[t._v("Select depot stock")]),t.selectedDepotProduct?s("div",{staticClass:"mb-6"},[s("vs-input",{staticClass:"mt-3 w-full",attrs:{placeholder:"Quantity","vs-placeholder":"Quantity"},model:{value:t.dispatchQuantity,callback:function(e){t.dispatchQuantity=e},expression:"dispatchQuantity"}})],1):t._e(),t.selectedDepotProduct?s("div",{staticClass:"product-item-active"},[s("p",[t._v("\n          "+t._s(t.selectedDepotProduct.product?t.selectedDepotProduct.product.product_name:"")+"\n          "+t._s(t.selectedDepotProduct.variant?t.selectedDepotProduct.variant.variant_name:"")+"\n        ")]),s("p",[t._v("Remaining: "+t._s(t.selectedDepotProduct.remaining_quantity)+" ")])]):t._l(t.availableStockProducts,(function(e,o){return s("div",{key:o,class:t.selectedDepotProduct?"product-item-active":"product-item",on:{click:function(s){t.selectedDepotProduct=e}}},[s("p",[t._v("\n          "+t._s(e.product?e.product.product_name:"")+"\n          "+t._s(e.variant?e.variant.variant_name:"")+"\n        ")]),s("p",[t._v("Remaining: "+t._s(e.remaining_quantity)+" ")])])})),0===t.availableStockProducts.length?s("div",{staticClass:"my-6"},[s("span",{staticStyle:{color:"#e60000"}},[t._v("No stock available in requested depot ")])]):t._e()],2)],1)],1)},a=[],c=s("bb36"),n=s("4a7a"),i=s.n(n),r=s("2567"),l={props:{selectedRequest:Object},components:{vSelect:i.a},data:function(){return{stockRequests:[],productInstance:{id:null,product_name:null,vendor_id:1,is_published:!1,categories_ids:[]},productFormDialog:!1,placesVisible:!1,placesFormVisible:!1,placeInstance:{id:null,place_name:null,district_id:null},places:[],productCategoriesArray:[{title:"Main Category",id:null,selected_category:null,selected_category_id:null,sub_categories:[]}],availableVendors:[],selectedVendor:null,assignedCategories:[],productVariantsVisible:!1,availableCategories:[],selectedCategory:{category_name:"All Categories"},availableDepots:[],selectedDepot:{depot_name:"All Depots"},availableStockProducts:[],selectedStockRequestProduct:null,selectedDepotProduct:null,stockRequest:{request_products:[]},dispatchFormDialog:!1,dispatchQuantity:null}},methods:{fetchStockRequestDetails:function(){var t=this;console.log("fetching details: "+this.selectedRequest.id),this.stockRequests=[];var e="/products/inventory/stock/request?id="+this.selectedRequest.id;c["a"].get(e).then((function(e){t.stockRequest=e.data.payload.request})).catch((function(t){console.log(t)}))},approveRequest:function(){var t=this;c["a"].post("/products/inventory/stock/request/approve",{id:this.selectedRequest.id}).then((function(e){t.fetchStockRequestDetails()})).catch((function(e){console.log(e),t.handleApiError(e)}))},showDispatchForm:function(){this.selectedStockRequestProduct.quantity<=this.selectedStockRequestProduct.dispatched_quantity?this.happilyNotify("Request fulfilled"):1===this.stockRequest.approved?(this.dispatchFormDialog=!0,this.getAvailableProducts()):this.sadlyNotify("Request Not Approved")},getAvailableProducts:function(){var t=this;c["a"].post("/products/inventory/stock/request/available",{requested_product_id:this.selectedStockRequestProduct.id,depot_id:this.selectedRequest.depot_id}).then((function(e){t.availableStockProducts=e.data.payload})).catch((function(e){console.log(e),t.handleApiError(e)}))},dispatchProduct:function(){var t=this;c["a"].post("/products/inventory/stock/request/dispatch",{requested_product_id:this.selectedStockRequestProduct.id,depot_product_id:this.selectedDepotProduct.id,quantity:this.dispatchQuantity}).then((function(e){t.selectedDepotProduct=null,t.selectedStockRequestProduct=null,t.happilyNotify("Product Dispatched"),t.fetchStockRequestDetails()})).catch((function(e){console.log(e),t.handleApiError(e)}))},fetchAvailableCategories:function(){var t=this;c["a"].get("/resources/products/categories/all").then((function(e){t.availableCategories=e.data.payload.categories,t.availableCategories.push(t.selectedCategory)})).catch((function(t){console.log(t)}))},fetchAvailableVendors:function(){var t=this;c["a"].get("/resources/products/vendors/all").then((function(e){t.availableVendors=e.data.payload.vendors})).catch((function(t){console.log(t)}))},fetchAvailableDepots:function(){var t=this;console.info("fetching depots.."),console.info(JSON.stringify(this.selectedDepot)),c["a"].get("/resources/assets/depots").then((function(e){t.availableDepots=e.data.payload.depots.data,t.availableDepots.push(t.selectedDepot),t.selectedDepot=t.availableDepots[0]})).catch((function(t){console.log(t)}))},handleApiError:function(t){this.$vs.notify({title:"Error",text:Object(r["a"])(t),iconPack:"feather",icon:"icon-alert-circle",color:"danger"})},happilyNotify:function(t){this.$vs.notify({title:"Success",text:t,color:"success"})},sadlyNotify:function(t){this.$vs.notify({title:"Error",text:t,color:"danger",time:15e3,position:"bottom-left"})}},created:function(){null==this.selectedRequest?(console.log("SelectedRequest==null Going back"),this.$router.go(-1)):console.log(this.selectedRequest.id)},mounted:function(){this.fetchStockRequestDetails()}},u=l,d=(s("3d67"),s("2877")),p=Object(d["a"])(u,o,a,!1,null,"9de7d256",null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-789a95c4.626e5e47.js.map