(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44cab750"],{"139a":function(t,e,a){"use strict";a("5fff")},"17ef":function(t,e,a){},"5fff":function(t,e,a){},c310:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"flex flex-wrap items-center mb-6"},[a("div",{staticClass:"flex-grow"},[a("div",{staticClass:"flex flex-wrap "},[a("h2",{staticClass:"font-bold",staticStyle:{"line-height":"48px !important",display:"flex","vertical-align":"middle !important"}},[a("vs-icon",{staticClass:"inline pt-2 mr-4",attrs:{size:"32px",icon:"view_quilt"}}),t._v("\n          Depot Stock\n        ")],1),a("v-select",{staticClass:"flex ml-4",attrs:{options:t.availalbleCategories,name:"category_name",label:"category_name",clearable:!1,placeholder:"Category",reduce:function(t){return t.id}},on:{input:function(e){return t.fetchStock()}},model:{value:t.selectedCategory,callback:function(e){t.selectedCategory=e},expression:"selectedCategory"}}),a("v-select",{staticClass:"flex ml-4",attrs:{options:t.availableDepots,name:"depot_name",label:"depot_name",clearable:!1,placeholder:"Depot"},on:{input:function(e){return t.fetchStock()}},model:{value:t.selectedDepot,callback:function(e){t.selectedDepot=e},expression:"selectedDepot"}}),a("vs-button",{staticClass:"py-0 ml-4",attrs:{icon:"refresh",type:"flat"},on:{click:function(e){return t.fetchStock()}}},[t._v("Refresh")])],1)])]),a("vx-card",[a("div",{staticClass:"px-6 py-6 rounded"},[a("vs-table",{attrs:{stripe:"",data:t.products},on:{selected:t.showVariantsStocks},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.data;return t._l(s,(function(e,i){return a("vs-tr",{key:i,attrs:{data:e}},[a("vs-td",[t._v("\n              "+t._s(s[i].product_name)+"\n            ")]),a("vs-td",[a("span",{staticStyle:{color:"#0d77e4","font-weight":"bold"}},[t._v(" "+t._s(s[i].remaining_quantity)+" ")])]),t._l(s[i].variants,(function(e,s){return a("vs-td",{key:s},[s>=3?a("span",[3===s?a("span",[t._v(" More ")]):t._e()]):a("vs-chip",{attrs:{color:"#e7f1fc"}},[a("span",{staticStyle:{color:"#084789"}},[t._v(" "+t._s(e.variant_name)+": ")]),a("span",{staticStyle:{color:"#084789","font-weight":"bold","margin-left":"4px"}},[t._v("\n                  "+t._s(e.remaining_quantity)+"\n                ")])])],1)}))],2)}))}}]),model:{value:t.selectedProduct,callback:function(e){t.selectedProduct=e},expression:"selectedProduct"}},[a("template",{slot:"thead"},[a("vs-th",[t._v("Product ")]),a("vs-th",[t._v(" Remaining QTY ")]),a("vs-th"),a("vs-th"),a("vs-th"),a("vs-th"),a("vs-th")],1)],2)],1),a("vs-popup",{attrs:{fullscreen:"",title:"",active:t.productVariantsVisible},on:{close:function(e){return t.closeProductVariantsDialog()},"update:active":function(e){t.productVariantsVisible=e}}},[a("div",[a("stock-details",{attrs:{depot:t.selectedDepot,product:t.productInstance},on:{closeProductVariants:t.closeProductVariantsDialog}})],1)])],1)],1)},i=[],o=a("bb36"),n=a("4a7a"),c=a.n(n),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"page-user-view"}},[t.stockFormVisible?a("div",{staticClass:"mb-12 "},[a("div",{staticClass:"flex flex-wrap"},[a("div",{staticClass:"flex-grow"},[a("h3",[t._v("Receive "+t._s(t.product.product_name)+" "+t._s(t.selectedVariant.variant_name)+",\n          "),a("span",{staticStyle:{"font-weight":"lighter"}},[t._v("Depot: "+t._s(t.depot.depot_name))])])])]),a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/3 w-1/4"},[a("div",{staticClass:"variant-form mt-6"},[a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full mt-4",attrs:{label:"Received Quantity",name:"received_quantity"},model:{value:t.depotStockInstance.received_quantity,callback:function(e){t.$set(t.depotStockInstance,"received_quantity",e)},expression:"depotStockInstance.received_quantity"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("received_quantity"),expression:"errors.has('received_quantity')"}],staticClass:"text-danger text-sm"},[t._v("\n            "+t._s(t.errors.first("received_quantity"))+"\n          ")]),a("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full mt-4",attrs:{label:"Batch Number",name:"batch_number"},model:{value:t.depotStockInstance.batch_number,callback:function(e){t.$set(t.depotStockInstance,"batch_number",e)},expression:"depotStockInstance.batch_number"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("batch_number"),expression:"errors.has('batch_number')"}],staticClass:"text-danger text-sm"},[t._v("\n            "+t._s(t.errors.first("batch_number"))+"\n          ")]),a("div",{staticStyle:{height:"8px"}}),a("span",{staticClass:"text-black text-sm"},[t._v(" Expiry Date ")]),a("datepicker",{attrs:{placeholder:"Expiry Date"},model:{value:t.depotStockInstance.expiry_date,callback:function(e){t.$set(t.depotStockInstance,"expiry_date",e)},expression:"depotStockInstance.expiry_date"}}),a("div",{staticClass:"flex mt-6"},[a("vs-button",{staticClass:"mr-4 mb-4",attrs:{type:"border",color:"danger"},on:{click:function(e){return t.closeStockForm()}}},[t._v("Cancel\n            ")]),a("vs-button",{ref:"saveButton",staticClass:"mr-4 mb-4",attrs:{color:"success"},on:{click:function(e){return t.saveReceivedStock()}}},[t._v("Save\n            ")])],1)],1)])])]):t.variantBatchesVisible?a("div",[a("div",{staticClass:"flex flex-wrap items-center mb-6"},[a("div",{staticClass:"flex-grow"},[a("div",{staticClass:"flex flex-wrap "},[a("vs-button",{staticClass:"mt-2 mr-2",attrs:{type:"border",radius:"",color:"danger",icon:"close"},on:{click:function(e){return t.closeStockBatchBreakdown()}}}),a("h2",{staticClass:"font-bold",staticStyle:{"line-height":"48px !important",display:"flex","vertical-align":"middle !important"}},[t._v("\n            Batches\n          ")]),a("vs-button",{staticClass:"py-0 ml-4",attrs:{icon:"refresh",type:"flat"},on:{click:function(e){return t.fetchVariantStock()}}},[t._v("Refresh")])],1)])]),a("vs-table",{attrs:{stripe:"",data:t.variantDepotBatches},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.data;return t._l(s,(function(e,i){return a("vs-tr",{key:i},[a("vs-td",[t._v(" "+t._s(s[i].batch_number))]),a("vs-td",[t._v(" "+t._s(s[i].expiry_date))]),a("vs-td",[t._v(" "+t._s(s[i].received_at))]),a("vs-td",[t._v(" "+t._s(s[i].received_quantity))]),a("vs-td",[t._v(" "+t._s(s[i].remaining_quantity))]),a("vs-td",[a("vs-progress",{attrs:{height:12,percent:s[i].remaining_quantity/s[i].received_quantity*100,color:"secondary"}})],1)],1)}))}}])},[a("template",{slot:"thead"},[a("vs-th",[t._v("Batch #")]),a("vs-th",[t._v("Expiry Date")]),a("vs-th",[t._v("Reception Date")]),a("vs-th",[t._v("Received QTY")]),a("vs-th",[t._v("Remaining QTY")]),a("vs-th",[t._v("Ratio")]),a("vs-th")],1)],2)],1):a("div",[a("div",{staticClass:"flex flex-wrap items-center mb-6"},[a("div",{staticClass:"flex-grow"},[a("div",{staticClass:"flex flex-wrap "},[a("h2",{staticClass:"font-bold",staticStyle:{"line-height":"48px !important",display:"flex","vertical-align":"middle !important"}},[t._v("\n           "+t._s(t.product.product_name)+"  "),a("span",{staticStyle:{"font-weight":"lighter","margin-left":"1em"}},[t._v(" Stocks")])]),a("vs-button",{staticClass:"py-0 ml-4",attrs:{icon:"refresh",type:"flat"},on:{click:function(e){return t.fetchVariantStock()}}},[t._v("Refresh")])],1)])]),a("vs-table",{attrs:{stripe:"",data:t.productsVariants},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.data;return t._l(s,(function(e,i){return a("vs-tr",{key:i},[a("vs-td",[t._v(" "+t._s(s[i].variant_name))]),a("vs-td",[t._v(" "+t._s(s[i].remaining_quantity))]),a("vs-td",[s[i].remaining_quantity>0?a("vs-chip",{attrs:{type:"border",color:"success"}},[t._v("In Stock")]):a("vs-chip",{attrs:{color:"danger"}},[t._v("Out Of Stock")])],1),a("vs-td",[a("vs-progress",{attrs:{height:12,percent:s[i].remaining_quantity/(2*s[i].restocking_quantity)*100,color:s[i].remaining_quantity<=s[i].restocking_quantity?"danger":"success"}})],1),a("vs-td",{attrs:{data:s[i].id}},[a("vs-button",{staticClass:"mr-12",attrs:{color:"secondary",size:"small"},on:{click:function(e){return t.showStockReceptionForm(s[i])}}},[t._v("Receive\n            ")]),a("vs-button",{staticClass:"mr-4",attrs:{type:"border",color:"secondary",size:"small"},on:{click:function(e){return t.showStockBatchBreakdown(s[i])}}},[t._v("Breakdown\n            ")])],1)],1)}))}}])},[a("template",{slot:"thead"},[a("vs-th",[t._v("Variant Name")]),a("vs-th",[t._v("Remaining quantity")]),a("vs-th",[t._v("Status")]),a("vs-th",[t._v("Level")]),a("vs-th")],1)],2)],1)])},l=[],d=a("fa33"),u={components:{vSelect:c.a,Datepicker:d["a"]},props:{product:Object,depot:Object},data:function(){return{user_data:null,productsVariants:[],rolesAvailable:[],selectedVariant:{},staffStatus:["Active","Suspended"],stockFormVisible:!1,depotStockInstance:{depot_id:null,product_variant_id:null,received_quantity:null,batch_number:null,expiry_date:null},variantBatchesVisible:!1,variantDepotBatches:[]}},watch:{product:function(t){this.fetchVariantStock()}},computed:{validateForm:function(){return!this.errors.any()}},methods:{closeProductVariants:function(){this.$emit("closeProductVariants")},fetchVariantStock:function(){var t=this;console.log("Fetching variants stock..");var e="/products/inventory/stock/product?product_id="+this.product.id+"&depot_id="+this.depot.id;o["a"].get(e).then((function(e){t.productsVariants=e.data.success?e.data.payload.variants:[]})).catch((function(t){console.log(t)}))},showStockReceptionForm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectedVariant=t,this.stockFormVisible=!0},closeStockForm:function(){this.stockFormVisible=!1},saveReceivedStock:function(){var t=this;this.depotStockInstance.depot_id=this.depot.id,this.depotStockInstance.product_variant_id=this.selectedVariant.id,console.log(JSON.stringify(this.depotStockInstance));var e="/products/inventory/stock/receive";o["a"].post(e,this.depotStockInstance).then((function(e){t.stockFormVisible=!1,t.depotStockInstance={},t.fetchVariantStock()})).catch((function(e){var a="Something went wrong";e.response&&(a=e.response.data.message),t.$vs.loading.close(),t.$vs.notify({time:12e3,color:"danger",title:"Failed",text:a}),console.log(e)}))},fetchVariantStockBreakdown:function(){var t=this;console.log("Fetching variants stock breakdown..");var e="products/inventory/stock/variant/breakdown?variant_id="+this.selectedVariant.id;o["a"].get(e).then((function(e){t.variantDepotBatches=e.data.success?e.data.payload.depot_products:[]})).catch((function(t){console.log(t)}))},showStockBatchBreakdown:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.selectedVariant=t,this.variantBatchesVisible=!0,this.fetchVariantStockBreakdown()},closeStockBatchBreakdown:function(){this.variantBatchesVisible=!1}},mounted:function(){this.fetchVariantStock()}},v=u,p=(a("139a"),a("2877")),h=Object(p["a"])(v,r,l,!1,null,"932891be",null),f=h.exports,_={components:{vSelect:c.a,StockDetails:f},data:function(){return{products:[],productInstance:{id:null,product_name:null,vendor_id:1,is_published:!1,categories_ids:[]},productFormDialog:!1,placesVisible:!1,placesFormVisible:!1,placeInstance:{id:null,place_name:null,district_id:null},places:[],productCategoriesArray:[{title:"Main Category",id:null,selected_category:null,selected_category_id:null,sub_categories:[]}],availableVendors:[],selectedVendor:null,assignedCategories:[],productVariantsVisible:!1,availalbleCategories:[],selectedCategory:{category_name:"All Categories"},availableDepots:[],selectedDepot:{depot_name:"All Depots"},selectedProduct:{}}},methods:{fetchStock:function(){var t=this;this.products=[];var e="/products/inventory/stock?category_id="+this.selectedCategory+"&depot_id="+this.selectedDepot.id;o["a"].get(e).then((function(e){t.products=e.data.payload.products.data})).catch((function(t){console.log(t)}))},showVariantsStocks:function(){console.info("Handling selection..."),null!=this.selectedDepot.id?(this.productInstance=this.selectedProduct,this.productVariantsVisible=!0):this.$vs.notify({time:3e3,color:"danger",title:"No Depot",text:"Select depot before selecting product"})},closeProductForm:function(){this.productFormDialog=!1},closeProductVariantsDialog:function(){this.productVariantsVisible=!1,this.fetchStock()},showProductVariants:function(t){this.productInstance=t,this.productVariantsVisible=!0},getAvailableCategories:function(t){var e=this,a=this.productCategoriesArray[t].id;o["a"].get("/resources/products/categories?parent_id="+a).then((function(a){e.productCategoriesArray[t].sub_categories=a.data.payload.categories})).catch((function(t){console.log(t)}))},fetchSubCategories:function(t){var e=this;o["a"].get("/resources/products/categories?parent_id="+t.selected_category.id).then((function(a){var s=a.data.payload.categories;if(s.length>0){console.log("Has sub categories");var i={};i.id=t.id,i.title=t.selected_category.category_name,i.selected_category_id=t.null,i.sub_categories=s,e.productCategoriesArray.push(i)}})).catch((function(t){console.log(t)}))},fetchAvailableCategories:function(){var t=this;o["a"].get("/resources/products/categories/all").then((function(e){t.availalbleCategories=e.data.payload.categories,t.availalbleCategories.push(t.selectedCategory)})).catch((function(t){console.log(t)}))},fetchAvailableVendors:function(){var t=this;o["a"].get("/resources/products/vendors/all").then((function(e){t.availableVendors=e.data.payload.vendors})).catch((function(t){console.log(t)}))},fetchAvailableDepots:function(){var t=this;console.info("fetching depots.."),console.info(JSON.stringify(this.selectedDepot)),o["a"].get("/resources/assets/depots").then((function(e){t.availableDepots=e.data.payload.depots.data,t.availableDepots.push(t.selectedDepot),t.selectedDepot=t.availableDepots[0]})).catch((function(t){console.log(t)}))}},created:function(){this.getAvailableCategories(0),this.fetchAvailableVendors(),this.fetchAvailableCategories(),this.fetchAvailableDepots()},mounted:function(){this.fetchStock()}},g=_,m=(a("ee1b2"),Object(p["a"])(g,s,i,!1,null,"1aacf2a9",null));e["default"]=m.exports},ee1b2:function(t,e,a){"use strict";a("17ef")}}]);
//# sourceMappingURL=chunk-44cab750.e7af7247.js.map